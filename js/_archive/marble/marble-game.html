<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>ğŸ”® ë§ˆë¸” ìŠˆíŒ… - ëª½ê¸€ë²¨</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{background:#0a0f1a;color:#fff;font-family:'Noto Sans KR',sans-serif;min-height:100vh;display:flex;align-items:center;justify-content:center;overflow:hidden}
@keyframes float{0%{transform:translateY(0)}100%{transform:translateY(-6px)}}
@keyframes pop{0%{transform:scale(1)}50%{transform:scale(1.3)}100%{transform:scale(0);opacity:0}}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.game{text-align:center;animation:fadeIn .5s ease-out}
.title{font-size:1.4em;color:#9b8aff;font-weight:700;margin-bottom:6px}
.subtitle{font-size:.45em;color:#8e92b8;margin-bottom:12px}
.info{font-size:.55em;color:#fbbf24;margin-bottom:10px}
.grid{display:inline-grid;gap:6px;justify-content:center;margin-bottom:16px}
.orb{width:48px;height:48px;display:flex;align-items:center;justify-content:center;font-size:24px;cursor:pointer;border-radius:50%;background:rgba(30,50,60,.8);border:2px solid rgba(155,138,255,.3);transition:all .15s;user-select:none}
.orb:hover{border-color:#9b8aff;background:rgba(60,80,100,.8);transform:scale(1.1)}
.orb:active{transform:scale(.9)}
.orb.dead{background:rgba(20,25,30,.4);border-color:transparent;cursor:default;font-size:12px;color:#333}
.progress-bar{width:80%;max-width:280px;height:8px;background:#1a1a2e;border-radius:4px;margin:0 auto 14px;overflow:hidden}
.progress-fill{height:100%;background:linear-gradient(90deg,#9b8aff,#c084fc);border-radius:4px;transition:width .3s}
.btn{padding:12px 28px;border:none;border-radius:12px;font-size:.6em;font-weight:700;cursor:pointer;font-family:'Noto Sans KR',sans-serif}
.btn-primary{background:linear-gradient(135deg,#9b8aff,#c084fc);color:#fff;box-shadow:0 4px 15px rgba(155,138,255,.3)}
.btn-secondary{background:rgba(30,40,50,.8);border:1px solid #9b8aff44;color:#9b8aff;margin-top:10px}
.combo{position:fixed;top:20%;left:50%;transform:translateX(-50%);font-size:1.5em;color:#fbbf24;font-weight:700;animation:pop .6s forwards;pointer-events:none}
.score-popup{position:absolute;color:#86efac;font-size:.7em;font-weight:700;animation:pop .5s forwards;pointer-events:none}
</style>
</head>
<body>
<div class="game" id="gameArea">
    <div class="title">ğŸ”® ë§ˆë¸” ìŠˆíŒ…!</div>
    <div class="subtitle">êµ¬ìŠ¬ì„ í„°ì¹˜í•˜ë©´ ì¸ì ‘í•œ ê°™ì€ ì¢…ë¥˜ë„ ì—°ì‡„ í­ë°œ!</div>
    <div class="info" id="info">ğŸ”® ì ìˆ˜: 0 | ë‚¨ì€ ë°œì‚¬: 20</div>
    <div class="progress-bar"><div class="progress-fill" id="progress" style="width:0%"></div></div>
    <div class="grid" id="grid" style="grid-template-columns:repeat(5,48px)"></div>
    <button class="btn btn-secondary" onclick="resetGame()">ğŸ”„ ë‹¤ì‹œ í•˜ê¸°</button>
</div>

<script>
var gems = ['ğŸ§š','ğŸ„','ğŸ’','â­','ğŸŒˆ','ğŸ¬','ğŸŒ™','ğŸ’§'];
var gridSize = 5;
var totalTargets = gridSize * gridSize;
var shots = 20;
var score = 0;
var combo = 0;
var targets = [];

function init() {
    targets = [];
    for (var i = 0; i < totalTargets; i++) {
        targets.push({ emoji: gems[Math.floor(Math.random() * gems.length)], alive: true });
    }
    score = 0; shots = 20; combo = 0;
    render();
}

function render() {
    var grid = document.getElementById('grid');
    grid.style.gridTemplateColumns = 'repeat(' + gridSize + ',48px)';
    var html = '';
    for (var i = 0; i < targets.length; i++) {
        var t = targets[i];
        if (!t.alive) {
            html += '<div class="orb dead">ğŸ’¨</div>';
        } else {
            html += '<div class="orb" onclick="shoot(' + i + ')" style="animation:float ' + (1 + Math.random() * 2).toFixed(1) + 's ease-in-out infinite alternate">' + t.emoji + '</div>';
        }
    }
    grid.innerHTML = html;
    document.getElementById('info').textContent = 'ğŸ”® ì ìˆ˜: ' + score + ' | ë‚¨ì€ ë°œì‚¬: ' + shots;
    var killed = targets.filter(function(t) { return !t.alive; }).length;
    document.getElementById('progress').style.width = Math.round(killed / totalTargets * 100) + '%';
}

function showCombo(count) {
    if (count < 2) return;
    var el = document.createElement('div');
    el.className = 'combo';
    el.textContent = 'ğŸ’¥ x' + count + ' ì½¤ë³´!';
    document.body.appendChild(el);
    setTimeout(function() { el.remove(); }, 600);
}

function shoot(i) {
    if (shots <= 0 || !targets[i].alive) return;
    var emoji = targets[i].emoji;
    targets[i].alive = false;
    shots--;
    var chain = 1;
    score += 30;

    // ì—°ì‡„ í­ë°œ â€” 8ë°©í–¥ ì¸ì ‘ ê°™ì€ ì¢…ë¥˜
    var neighbors = [i-1, i+1, i-gridSize, i+gridSize, i-gridSize-1, i-gridSize+1, i+gridSize-1, i+gridSize+1];
    var toCheck = [];
    neighbors.forEach(function(j) {
        if (j >= 0 && j < totalTargets && targets[j] && targets[j].alive && targets[j].emoji === emoji) {
            targets[j].alive = false;
            score += 25;
            chain++;
            // 2ì°¨ ì—°ì‡„
            [j-1,j+1,j-gridSize,j+gridSize].forEach(function(k) {
                if (k >= 0 && k < totalTargets && targets[k] && targets[k].alive && targets[k].emoji === emoji) {
                    targets[k].alive = false;
                    score += 20;
                    chain++;
                }
            });
        }
    });

    if (chain >= 2) showCombo(chain);
    render();

    // ì™„ë£Œ ì²´í¬
    var alive = targets.filter(function(t) { return t.alive; }).length;
    if (alive === 0) {
        score += shots * 50; // ë‚¨ì€ ë°œì‚¬ ë³´ë„ˆìŠ¤
        document.getElementById('info').innerHTML = 'ğŸ‰ ì™„ë²½ í´ë¦¬ì–´! ì´ ' + score + 'ì ! (ë‚¨ì€ ë°œì‚¬ ë³´ë„ˆìŠ¤ +' + (shots*50) + ')';
    } else if (shots <= 0) {
        document.getElementById('info').innerHTML = 'â° ì¢…ë£Œ! ì´ ' + score + 'ì ! (ë‚¨ì€ êµ¬ìŠ¬: ' + alive + 'ê°œ)';
    }
}

function resetGame() { init(); }
init();
</script>
</body>
</html>
